<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <title>
        	ANIME BY ID
        </title>
        
        <link rel="stylesheet" th:href="@{/css/styles.css}" />
    </head>
    
    <body>
    	<a th:href="@{/home}">
			Back to home page
		</a>
		
    	<img align="left" th:src="${anime.images.jpg.large_image_url}">
    	
    	<br><br>
    	
    	<a th:href="@{/anime/viewed/{animeId}(animeId = ${anime.mal_id})}">
	        <span th:text="viewed"></span>
	    </a>
    	
		<table class="table table-primary">
			<tbody>
				<tr th:if="${anime.title}">
					<td>Title:</td>
			        <td><p th:text="${anime.title}"/></td>
				</tr>
				<tr th:if="${anime.year}">
		        	<td>Year:</td>
					<td><p th:text="${anime.year}"/></td>
		        </tr>
				<tr th:if="${anime.episodes}">
		        	<td>Episodes:</td>
					<td><p th:text="${anime.episodes}"/></td>
		        </tr>
				<tr th:if="${anime.rank}">
		        	<td>Rank:</td>
					<td><p th:text="${anime.rank}"/></td>
		        </tr>
				<tr th:if="${anime.score}">
		        	<td>Score:</td>
					<td><p th:text="${anime.score}"/></td>
		        </tr>
				<tr th:if="${anime.type}">
		        	<td>Type:</td>
					<td><p th:text="${anime.type}"/></td>
		        </tr>
				<tr th:if="${anime.status}">
		        	<td>Status:</td>
					<td><p th:text="${anime.status}"/></td>
		        </tr>
				<tr th:if="${anime.rating}">
		        	<td>Rating:</td>
					<td><p th:text="${anime.rating}"/></td>
		        </tr>
				<tr th:if="${anime.synopsis}">
		        	<td>Synopsis:</td>
					<td><p th:text="${anime.synopsis}"/></td>
		        </tr>
				<tr th:if="${anime.background}">
		        	<td>Background:</td>
					<td><p th:text="${anime.background}"/></td>
		        </tr>
		        <tr th:if="${anime.trailer.embed_url}">
		        	<td>Trailer:</td>
					<td><iframe width="960" height="540" th:src="${anime.trailer.embed_url}"></iframe></td>
		        </tr>
		    </tbody>
		</table>
		
		<table class="table table-striped" th:if="${!reviews.empty}">
		    <thead>
		        <tr align="center">
		            <th class="col-1 text-truncate">Username</th>
		            <th class="col-4 text-truncate">Review</th>
		            <th class="col-1 text-truncate" />
		        </tr>
		    </thead>
		    <tbody>
		        <tr th:each="review: ${reviews}">
				    <td th:text="${review.user.username}" align="center"/>
				    <td th:text="${review.content}" align="center"/>
				    <td align="center">
				    	<a th:href="@{/reviews/remove/{reviewId}(reviewId = ${review.id})}"
				    	   th:if="${#authentication.principal.username} == ${review.user.username}">
					        <span th:text="DELETE"></span>
					    </a>
				    </td>
				    
		        </tr>
		    </tbody>
		</table>
		
		<form th:action="@{/reviews/add}" 
              	th:object="${reviewForm}" method="POST" class="form-control-plaintext">
            <input type="hidden" th:field="*{animeId}" id="animeId">
            
	        <label>
	        	Add review:
	        </label>
	        
	        <div style="margin-bottom: 25px" class="input-group">
				<span class="input-group-addon">
					<i class="glyphicon glyphicon-user"></i>
				</span>
				<input type="text" th:field="*{content}" placeholder="content" 
					class="form-control" th:errorclass="fieldError" />
			</div>
			
			<div th:if="${#fields.hasErrors('content')}"
				style="margin-bottom: 25px" class="text-danger">
				<ul>
					<li th:each="err : ${#fields.errors('content')}"
						th:text="${err}" />
				</ul>
			</div>
			
			<div style="margin-top: 10px" class="form-group">
				<div class="col-sm-6 controls">
					<button type="submit" class="btn btn-primary">
						Submit
					</button>
				</div>
			</div>
	    </form>
    </body>
</html>
